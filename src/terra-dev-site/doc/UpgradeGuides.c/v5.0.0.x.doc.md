# v5.0.0 Upgrade Guide

This document will provide information on upgrading from Terra Toolkit `4.0.0` to `5.0.0`.

## site.config

A few sections have been removed from site.config.

### Theme import

The need for this option has been removed with the aggregate-themes project.

### Extension config

The new navigation has a tighter definition of extensions and the github link no longer makes sense as an extension.

## navigation.config

### Hide

The option to hide a navigation tab has been removed. This option was always a little weird. We wanted to hide the test tab for terra-ui and have access to it for sites with tests. It has caused discoverability issues and it's best if we just show the tab if available.

## Browser Router

Previously terra-dev-site used a hash router `/#/` to display it's pages. This interferes with anchor tags which also use the hash to denote where to go on the page. To resolve this terra-dev-site has switched to a browser router. Current links using the hash router will still resolve, slash routes with the hash will be redirected to the equivalent non hash route.

## Testing

Webdriver tests are slower than they should be because our [global before hook performs a `browser.refresh()`](https://github.com/cerner/terra-dev-site/blob/master/config/wdio/wdio.conf.js#L24-L29) which:

1. slows down tests significantly
2. increased test flakiness as the selenium grid session is terminated and a new request is made for each test `describe` block.

This global hook also enabled tests to be written poorly because the refresh will automatically clean up the current page's state, when tests should be working through a workflow, not a single page's state. _IF_ a refresh is needed (which should be infrequent) it should be manually triggered by the test itself.

Here is a video showing the a test run using the current configuration and then a test run that has removed this configuration: https://cl.ly/7a7d955aaa8e.

Removing this is non-passive and will break tests.

## Dependencies

Unused dependencies have been removed. Webpack and terra-toolkit related dependencies have been moved to peer dependencies.This will decouple terra-dev-site from installing webpack. The webpack version should be set by the consumer.

Dev site defined xfc as a dependency and then initialized the XFC Provider by default. Most sites do not need this--this had accidentally been included because terra-core & terra-ui needs and XFC provider to correctly load the embedded-content-consumer examples.

## Theme plugin

This plugin no longer leveraged in our wepback config. Themes can now be aggregated by using terra-toolkit aggregate-themes pre-build script.

